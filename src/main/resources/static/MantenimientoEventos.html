<!DOCTYPE html>
<html lang="es" ng-app="app">
<head>
    <meta charset="UTF-8">
    <title>ClubSis-Mantenimiento Eventos</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular-route.min.js"></script>
    <link rel="shortcut icon" type="image/x-icon" href="/img/Logos/ClubSisIcon.ico">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0">
    <link rel='stylesheet' href='webjars/bootstrap/3.3.6/css/bootstrap.min.css'/>
    <link rel="stylesheet" href="webjars/fancybox/2.1.5/jquery.fancybox.css" type="text/css" media="screen"/>
    <title>Title</title>
    <link rel='stylesheet' href='css/estilosListaBungalows.css'/>
    <link rel='stylesheet' href='css/estilosPlantillaBotonesAcciones.css'/>
    <script type="text/javascript" src="js/plantillaBotonesAccion.js"></script>
    <script type="text/javascript">
        Date.prototype.ddmmyyyy = function() {
            var yyyy = this.getFullYear().toString();
            var mm = (this.getMonth()+1).toString(); // getMonth() is zero-based
            var dd  = this.getDate().toString();
            return (dd[1]?dd:"0"+dd[0])+ "/"+(mm[1]?mm:"0"+mm[0])+"/"+yyyy ; // padding
        };

        function cambiarDeUsuario(accionesXElemento,nuevoUsuario,Agregar,funciones){
            if(nuevoUsuario==actualUsuario)return;
            actualUsuario=nuevoUsuario;
            eliminarBotones();
            agregarBotonAgregar(accionAgregar,Agregar,nuevoUsuario);
            agregarBotonesAListas(accionesXElemento,funciones,nuevoUsuario);
        }

        var DATAEVENTOS;
        /* datos generales */
        function getID(target){
            var id=target.parentElement.parentElement.parentElement.parentElement.getAttribute("ID");
            return id.replace(/\D/g,'');
        }
        function Ver(e){
            e.preventDefault();
            location.href="EventInformacion.html?id="+getID(e.target);
        }
        function Editar(e){location.href="edicionEventos.html?id="+getID(e.target);event.preventDefault();}
        function Eliminar(e){location.href="loginUsuario.html";event.preventDefault();}
        function Participar(e){location.href="participarEvento.html?id="+getID(e.target);event.preventDefault();}

        function Agregar(e){location.href="registrarEvento.html";event.preventDefault();}
        var funciones=[Ver,Participar,Editar,Eliminar];

        //json HARDCODEADO
        //la misma data esta en reservaBungalows1.html
        var accionesXElemento=[
            /*ver,editar,eliminar,reservar,registrar*/
            //["Reservar","Anular","Modificar"],//usuario:SuperAdministrador
            ["Ver","Participar","Editar","Eliminar"],//ADIMINISTRADOR
            //["Reservar","Anular","Modificar"],//usuario:Administradio
            ["Ver","Participar"]];//usuario:Socio
        var accionAgregar=[["Registrar"],//usuario:ADMINISTRADOR
            []];//usuario:Socio

        var dataJSON=[
            {id:0,url:"img/Eventos/newYear.jpg",nombre:"Feliz Año Nuevo 2016",sede:{id:0,nombre:"Chorrillos",direccion:"av"},empresa:"Nestle",fechaInicio:3,fechaFin:4,fechaInicioInscripcion:2,fechaFinInscripcion:2,tarifas:[{id:1,descripcion:"a",precio:0.00,nombre:"b"},{id:2,descripcion:"c",precio:1.00,nombre:"d"}],reglamento:"....",estado:0,descripcion:"asd",isGratuito:0,isPublico:1},
            {id:1,url:"img/Eventos/newYear.jpg",nombre:"Feliz Año Viejo 2016",sede:{id:1,nombre:"Santa Anita",direccion:"av"},empresa:"Nestle",fechaInicio:3,fechaFin:4,fechaInicioInscripcion:2,fechaFinInscripcion:2,tarifas:[{id:1,descripcion:"a",precio:0.00,nombre:"b"},{id:2,descripcion:"c",precio:1.00,nombre:"d"}],reglamento:"....",estado:0,descripcion:"asd",isGratuito:0,isPublico:1},
            {id:2,url:"img/Eventos/newYear.jpg",nombre:"Feliz Dia de la Madre 2016",sede:{id:0,nombre:"Chorrillos",direccion:"av"},empresa:"Nestle",fechaInicio:3,fechaFin:4,fechaInicioInscripcion:2,fechaFinInscripcion:2,tarifas:[{id:1,descripcion:"a",precio:0.50,nombre:"b"},{id:2,descripcion:"c",precio:1.50,nombre:"d"}],reglamento:"....",estado:0,descripcion:"asd",isGratuito:0,isPublico:1}
        ];

    </script>
    <script type="text/javascript">
        //app script
        var app = angular.module('app', []);
    </script>
    <script type="text/javascript">
        app.controller('EventosController', function ($scope, $http) {
            $http.get('http://shopname.myshopify.com/products.json').success(function (data) {
                //    api/tarifaeventos
                //DATAEVENTOS=data;//eso deberia ser pero como no tengo link
                DATAEVENTOS=dataJSON;
                llenarListaBungalows1(DATAEVENTOS);
                cambiarDeUsuario(accionesXElemento,administrador,Agregar,funciones);
                mostrarNext5();
            })
        });
    </script>
</head>
<body ng-controller="EventosController">
<div id="headerAdministrador"></div>
<div class="container">
    <!--example link: http://www.trivago.pe/?iPathId=86439&iGeoDistanceItem=0&aDateRange[arr]=2016-05-08&aDateRange[dep]=2016-05-09&iRoomType=7&cpt=8643903&iViewType=0&bIsSeoPage=false&bIsSitemap=false    -->
    <!--acciones:            Agregar       Anular               MOdificar             Reservar           -->
    <div>
        <div class="form-group"><!--filtrado-->
            <h4 style="background: #008D34;color: white;padding-left: 30px;margin-left: 0px;padding-top: 2px;padding-bottom: 2px;margin-top: 0px;">CONSULTA DE EVENTOS
                <!--    <a href="javascript:void(0)" class="btn btn-primary pull-right">Buscar</a>-->
            </h4>

            <form class="form-horizontal">
                <div class="row">
                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label for="tipo" class="col-md-4 control-label">Sede</label>
                            <div class="col-md-8">
                                <select class="form-control" id="sede">
                                    <option>Elegir</option>
                                    <option>Chosica</option>
                                    <option>Namekusein</option>
                                    <option>Planeta del gran Kaiosama</option>
                                    <option>Planeta Tierra</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label for="estado" class="col-md-4 control-label">Estado</label>
                            <div class="col-md-8">
                                <select class="form-control" id="estado">
                                    <option>Libre</option>
                                    <option>Reservado</option>
                                    <option>En Mantenimiento</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label for="descripcion" class="col-md-4 control-label">Descripcion</label>
                            <div class="col-md-8">
                                <input type="text" class="form-control" id="descripcion" placeholder="Palabra clave de descripción de Evento">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <div class="col-md-12" style="visibility: hidden;">
                                <input type="text" class="form-control" placeholder="">
                            </div>
                        </div>
                        <!--<div class="form-group">
                            <label for="descripcion" class="col-md-12 control-label" style="visibility: hidden;">...</label>
                        </div>-->
                    </div>
                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label class="control-label col-md-4">Apartir de</label>
                            <div class="input-group input-append date col-md-8">
                                <input id="date-picker-DiaEntrada" type="text" class="date-picker form-control col-xs-6" />
                                <label for="date-picker-DiaEntrada" class="input-group-addon btn"><span class="glyphicon glyphicon-calendar"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label class="control-label col-md-4">Antes de</label>
                            <div class="input-group input-append date col-md-8">
                                <input id="date-picker-DiaSalida" type="text" class="date-picker form-control col-xs-6" />
                                <label for="date-picker-DiaSalida" class="input-group-addon btn"><span class="glyphicon glyphicon-calendar"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label class="control-label col-md-4">Inscripcion Inicio</label>
                            <div class="input-group input-append date col-md-8">
                                <input id="date-picker-InscripcionInicio" type="text" class="date-picker form-control col-xs-6" />
                                <label for="date-picker-InscripcionInicio" class="input-group-addon btn"><span class="glyphicon glyphicon-calendar"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-lg-5">
                        <div class="form-group">
                            <label class="control-label col-md-4">Inscripcion Fin</label>
                            <div class="input-group input-append date col-md-8">
                                <input id="date-picker-InscripcionFin" type="text" class="date-picker form-control col-xs-6" />
                                <label for="date-picker-InscripcionFin" class="input-group-addon btn"><span class="glyphicon glyphicon-calendar"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-7 col-lg-7">
                    </div>
                    <div class="col-sm-5 col-lg-5">
                        <div class="form-group" style="margin-left: 60px;">
                            <a href="javascript:void(0)" class="btn btn-primary">Buscar</a>
                            <a href="javascript:void(0)" class="btn btn-primary">Limpiar</a>
                            <!--Opcional-->
                            <!--<a href="javascript:void(0)" class="btn btn-primary">Eliminar Marcados</a>-->
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="panel panel-primary"><!--listas-->
        <div id="topMostrar" class="panel-heading">
            <span class="col-xs-9 titulo">Eventos</span>
            <!--<span class="pull-right" id="accionAgregar">
                <input type="submit" tabindex="3" value="+ Agregar" class="btn btn-primary"/>
            </span><br>-->
        </div>
        <div id="listaBungalows" class="list-group list-group-flush">
      <!--      <a href="#" class="list-group-item hidden">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="panel-more1 imagenBungalow">
                            <img src="img/Eventos/newYear.jpg" />
                        </div>
                        <div class="panel-info" style="padding-left: 2em;">
                            <p><h1><strong>Fiesta de Año Nuevo 2016</strong></h1></p>
                            <p>Evento 1378</p>
                            <p>
                                <span class="bg-info">
                                    Chorrillos
                                </span>
                            </p>
                            <h3>Empresa Nestle</h3>
                        </div>
                        <div class="panel-more1" style="padding-left: 2em;">
                            <div>
                                <h4>Inicio de Inscripciones: 17/07/2016</h4>
                                <h4>Fin de Inscripciones: 14/08/2016</h4>
                                <h4>Fecha Inicio: 17/08/2016</h4>
                                <h4>   Fecha Fin: 17/08/2016</h4>
                            </div>
                            <h3>Asociado: S/. 50.00 - Inivitado: S/.80.00</h3>
                        </div>
                        <div class="panel-more1 social-box botonesAcciones">
                            <button tabindex="3" value="Ver" class="btn btn-primary rght-box accionLista" target="_blank">Ver</button>
                            <button tabindex="3" value="Reservar" class="btn btn-primary rght-box accionLista" target="_blank">Reservar</button>
                            <button tabindex="3" value="Editar" class="btn btn-primary rght-box accionLista" target="_blank">Editar</button>
                            <button tabindex="3" value="Eliminar" class="btn btn-primary rght-box accionLista" target="_blank">Eliminar</button>
                        </div>
                    </div>
                </div>
            </a>-->

        </div>
    </div>
</div>
<div class="pull-right"><!--esto solo es para verificar que funciona, luego se borrara-->
    <button onclick="cambiarDeUsuario(1,Agregar,funciones)" class="btn btn-primary pull-right">Como Socio</button>
    <button onclick="cambiarDeUsuario(0,Agregar,funciones)" class="btn btn-primary pull-right">Como Administrador</button><br>
    <span>Hacer Click en Cualquiera para mostrar los botones por cada tipo de Usuario, luego se borrara es solo para verificar</span>
</div>
<div id="footer"></div>
<script src="webjars/jquery/2.2.3/jquery.min.js"></script>
<script src="webjars/jquery-ui/1.11.4/jquery-ui.min.js"></script>
<script src="webjars/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script type="text/javascript" src="webjars/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<script type="text/javascript" src="webjars/fancybox/2.1.5/jquery.fancybox.js"></script>
<script src="js/principal.js"></script>
<script type="text/javascript" src="js/generarElementoBungalow.js"></script>
<script type="text/javascript">
    /*
     {id:"0",imgsrc:"img/Eventos/newYear.jpg",nombre:"Feliz Año Nuevo 2016",sede:"Chorrillos",empresa:"Nestle",
     fechaInicio:"31/12/2015",fechaFin:"1/1/2016",inicioInscripciones:"1/12/2015",finInscipciones:"29/12/2015",
     precios:{asociado:"50.00",invitado:"80.00"}}
    * */
    function retornaPanelBody2(databungalow){
        var panel = $('<div></div>').attr({
            class: 'panel-body',
        });
        var b=new Array();
        b[0]=retornaImagenBungalow1(databungalow.url);
        b[1]=retornaPanelInfo1(databungalow.id,databungalow.nombre,databungalow.sede,databungalow.isGratuito,databungalow.isPublico);
        b[2]=retornCaracteristicas1(databungalow.fechaInicio,databungalow.fechaFin,databungalow.fechaInicioInscripcion,
                databungalow.fechaFinInscripcion,databungalow.tarifas);
        for(var j=0;j<b.length;j++)
            panel.append(b[j]);
        return panel;
    }

    function retornaImagenBungalow1(imgsrc){
        return $('<div></div>').attr({
            class: 'panel-more1 imagenBungalow',
        }).append($('<img />').attr({
            src:imgsrc
        }));
    }

    function retornaPanelInfo1(id,nombre,sede,isGratuito,isPublico){
        var panelInfo=$('<div></div>').attr({
            class: 'panel-info',
            style: "padding-left: 2em;"
        });
        var b=new Array();
        b[0]=retornaTitulo1(nombre);
        b[1]=$('<p></p>').html("Evento "+id);
        b[2]=retornaSedes1(sede.nombre);
        b[3]=$('<h3></h3>').html((isPublico)?"Publico":"Privado"+(isGratuito)?" y Gratuito":"");
        for(var j=0;j<b.length;j++)
            panelInfo.append(b[j]);
        return panelInfo;
    }

    function retornaTitulo1(t){
        return $('<h1></h1>').append($("<strong></strong>").html(t));
    }
    function retornaSedes1(sede){
        if(sede.length==0)return $('<p></p>').html("No Sedes Disponibles");
        else {
            var parrafo=$('<p></p>');
            parrafo.append($("<span></span>").attr({class:"bg-info"}).html(sede));
            return parrafo;
        }
    }

    function retornCaracteristicas1(fechaInicio,fechaFin,inicioInscripciones,finInscipciones,precios){
        var caracteristicas=$('<div></div>').attr({
            class: 'panel-more1',
            style: "padding-left: 2em;"
        });
        var b=new Array();
        b[0]=retornaMasCaracteristicas1(fechaInicio,fechaFin,inicioInscripciones,finInscipciones);
        b[1]=retornaPrecios(precios);//$("<h3></h3>").html("Precio: S/. "+precio);
        for(var j=0;j<b.length;j++)
            caracteristicas.append(b[j]);
        return caracteristicas;
    }

    function retornaMasCaracteristicas1(fechaInicio,fechaFin,inicioInscripciones,finInscipciones){
        var div=$('<div></div>');
        var b=new Array();
        b[0]=$("<h4></h4>").html("Inicio de Inscripciones: "+new Date(inicioInscripciones).ddmmyyyy());
        b[1]=$("<h4></h4>").html("Fin de Inscripciones: "+new Date(finInscipciones).ddmmyyyy());
        b[2]=$("<h4></h4>").html("Fecha Inicio: "+new Date(fechaInicio).ddmmyyyy());
        b[3]=$("<h4></h4>").html("Fecha Fin: "+new Date(fechaFin).ddmmyyyy());
        for(var j=0;j<b.length;j++)
            div.append(b[j]);
        return div;
    }

    function retornaPrecios(precios) {
        var str="";
        for(var i=0;i<precios.length;i++)
                str += (precios[i].nombre + ": S/" + precios[i].precio.toFixed(2) + " - ");
        str = str.substring(0,str.length-2);
        return $("<h3></h3>").html(str);
    }
</script>
<script type="text/javascript">
    /*******************LEAN LOS COMENTARIOS ************************/
    $(".date-picker").datepicker();
</script>
</body>
</html>

